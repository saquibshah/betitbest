!function(){"use strict";var e,t,a;e=function(){var e=function(){jQuery().wysihtml5&&$(".wysihtml5").size()>0&&$(".wysihtml5").wysihtml5({stylesheets:["assets/plugins/bootstrap-wysihtml5/wysiwyg-color.css"]})};return{init:function(){e()}}}(),t=function(){var e=0;return function(t,a){clearTimeout(e),e=setTimeout(t,a)}}(),a=function(){var e,a,n,l,r,o,i,s,u;return e=function(){var e,t,a;if(e=window.location.href.replace(window.location.protocol+"//"+window.location.hostname,""),t=(e.match(/\//g)||[]).length,t>2)for(a=0;t-2>a;++a)e=e.substring(0,e.lastIndexOf("/"));-1===e.substring(1).indexOf("/")?$(".page-sidebar-menu li.start").addClass("active"):$('.page-sidebar-menu a[href="'+e.replace("#","")+'"]').parent().addClass("active")},a=function(e,a,n){var l,r,o;r={oLanguage:{sLengthMenu:"Zeige _MENU_ Datens&auml;tze pro Seite",sInfo:"Zeige Datensatz _START_ bis _END_ von _TOTAL_",sInfoFiltered:"(gefiltert aus _MAX_ Datens&auml;tzen)",sZeroRecords:"Keine Datens&auml;tze verf&uuml;gbar",sInfoEmpty:"Zeige 0 von 0 Datens&auml;tzen"},sPaginationType:"bootstrap_full_number",sDom:"<'row'<'col-md-6 col-sm-12'l><'col-md-6 col-sm-12'p>r><'table-scrollable't><'row'<'col-md-5 col-sm-12'i><'col-md-7 col-sm-12'p>>",bProcessing:!0,aLengthMenu:[[20,50,100,150],[20,50,100,150]],iDisplayLength:20,bServerSide:!0,bFilter:!0,bStateSave:!0,bSortCellsTop:!0,aaSorting:[[0,"asc"]],sAjaxSource:a,sServerMethod:"post",fnServerParams:function(e){var t,a,n,l,r;for(e.push({name:"csrf_betitbest_securitytoken",value:csrf_value}),t=$("thead .filter :input"),a=0;a<e.length;a++)e[a].name.match(/^(mDataProp|sSearch|b(Regex|Searchable|Sortable))_/)&&(e.splice(a,1),a--);for(a=0;a<t.length;a++)r={},n=a,l=t.eq(n),r.name="filter_"+l.attr("name"),"checkbox"===l.attr("type")?r.value=l.is(":checked"):r.value=l.val(),e.push(r)},fnStateLoaded:function(t,a){var n,l;for(n=0;n<a.aoSearchCols.length;n++)l=$("thead .form-filter",e).eq(n),"checkbox"===l.attr("type")?a.aoSearchCols[n].sSearch===!0?l.prop("checked",!0):l.prop("checked",!1):l.val(a.aoSearchCols[n].sSearch)},fnStateSaveParams:function(e,t){var a,n,l,r;for(t.aoSearchCols=[],n=$("thead .filter :input"),a=0;a<n.length;a++)l=n.eq(a),r={bCaseInsensitive:!0,bRegex:!1,bSmart:!1},"checkbox"===l.attr("type")?r.sSearch=l.is(":checked"):r.sSearch=l.val(),t.aoSearchCols.push(r)}};for(o in n)n.hasOwnProperty(o)&&(r[o]=n[o]);l=$(e).dataTable(r),$('input.form-filter[type="checkbox"]',e).on("change",function(){l.fnFilter()}),$('input.form-filter[type="text"]',e).on("keyup",function(){t(function(){l.fnFilter()},500)})},n=function(){$("#sporttable").dataTable({aoColumnDefs:[{aTargets:[0]}],aaSorting:[[1,"asc"]],aLengthMenu:[[20,-1],[20,"All"]],iDisplayLength:20}),$("#keywordtable").length&&a("#keywordtable","/backend/keyword/getAsync",{aaSorting:[[1,"asc"]],aoColumnDefs:[{bSortable:!1,aTargets:[3,4,5]}]}),$("#feedtable").length&&a("#feedtable","/backend/feed/getAsync",{aaSorting:[[1,"asc"]],aoColumnDefs:[{bSortable:!1,aTargets:[7]}]}),$("#posttable").length&&a("#posttable","/backend/post/getAsync",{aaSorting:[[1,"desc"]],aoColumnDefs:[{bSortable:!1,aTargets:[8]}]}),$("#teamtable").length&&a("#teamtable","/backend/team/getAsync",{aaSorting:[[1,"asc"]],aoColumnDefs:[{bSortable:!1,aTargets:[2,3,4,5]}]}),$("#categorytable").length&&a("#categorytable","/backend/category/getAsync",{aaSorting:[[1,"asc"]],aoColumnDefs:[{bSortable:!1,aTargets:[3]}],fnRowCallback:function(e,t){if("["===t[1].substring(0,1)){var a,n;for(a=t[1].substring(1,t[1].indexOf("]")).split(","),n=0;n<a.length;n++)switch(a[n]){case"disabled":$("td:eq(1)",e).html(t[1].substring(t[1].indexOf("]")+1)),$("td",e).addClass("grey")}}}}),$("#tournamenttable").length&&a("#tournamenttable","/backend/tournament/getAsync",{aaSorting:[[1,"asc"]],aoColumnDefs:[{bSortable:!1,aTargets:[5]}],fnRowCallback:function(e,t){if("["===t[1].substring(0,1)){var a,n;for(a=t[1].substring(1,t[1].indexOf("]")).split(","),n=0;n<a.length;n++)switch(a[n]){case"hidden":$("td:eq(1)",e).html(t[1].substring(t[1].indexOf("]")+1)),$("td",e).addClass("grey")}}}}),$("#logtable").length&&a("#logtable","/backend/log/getAsync",{aaSorting:[[0,"desc"]],aoColumndDefs:[{bSortable:!1,aTargets:[6,7]}],fnDrawCallback:function(){$("#logtable tbody td:last-child span.disabled").parents().eq(1).children("td").addClass("grey"),$("#logtable tbody .popovers").popover()}})},l=function(){$(".keyword-container").on("click","button",function(){var e,t,a,n,l,r,o;if(e=$(this),t=$("#remove_keywords_string"),a=t.val(),n=e.data("option").replace("delete-keyword-matching-",""),e.hasClass("default")){for($(e).hasClass("was-red")?$(e).removeClass("was-red default greytext").addClass("red"):$(e).removeClass("was-yellow default greytext").addClass("yellow"),$(".fa",e).removeClass("fa-undo").addClass("fa-ban"),l=t.val().split(","),r="",o=0;o<l.length;++o)l[o]!==n&&(""!==r&&(r+=","),r+=l[o]);t.val(r)}else $(e).hasClass("red")?$(e).removeClass("red").addClass("was-red default greytext"):$(e).removeClass("yellow").addClass("was-yellow default greytext"),""!==a&&(a+=","),a+=n,t.val(a),$(".fa",e).removeClass("fa-ban").addClass("fa-undo")}),$("#dynAddTwitterButton").click(function(e){var t,a,n;e.preventDefault(),t={},a="",t.tw_id=$("#twitter-channel-id").val(),t.tw_title=$("#twitter-channel-title").val(),t.tw_team=$("#twitter-channel-reluid").val(),$("#twitter-channel-id").val(""),$("#twitter-channel-title").val(""),""!==t.tw_id&&""!==t.tw_title?(n=$("#twitter-channels").val(),$("#twitter-channels").val(n+"[-1]["+t.tw_id+"]["+t.tw_title+"]||"),$(".twitter-channel-container").append('<button class="btn blue" type="button" data-option="delete-twitter-channel-new">'+t.tw_title+" ("+t.tw_id+') <i class="fa-ban fa"></i></button>&nbsp;'),a="<h3>Erfolg</h3><br/>Twitter Channel wurde erfolgreich hinzugefügt.",bootbox.alert(a)):(a="<h3>Fehler</h3><br/>Sie müssen alle Felder ausfüllen.",bootbox.alert(a))}),$("#dynAddInstagramButton").click(function(e){var t,a,n;e.preventDefault(),t={},a="",t.tw_id=$("#instagram-channel-id").val(),t.tw_name=$("#instagram-channel-name").val(),t.tw_title=$("#instagram-channel-title").val(),t.tw_team=$("#instagram-channel-reluid").val(),$("#instagram-channel-id").val(""),$("#instagram-channel-name").val(""),$("#instagram-channel-title").val(""),""!==t.tw_id&&""!==vales.tw_name&&""!==t.tw_title?(n=$("#instagram-channels").val(),$("#instagram-channels").val(n+"[-1]["+t.tw_id+"]["+t.tw_name+"]["+t.tw_title+"]||"),$(".instagram-channel-container").append('<button class="btn blue" type="button" data-option="delete-instagram-channel-new">'+t.tw_title+" ("+t.tw_name+') <i class="fa-ban fa"></i></button>&nbsp;'),a="<h3>Erfolg</h3><br/>Instagram Channel wurde erfolgreich hinzugefügt.",bootbox.alert(a)):(a="<h3>Fehler</h3><br/>Sie müssen alle Felder ausfüllen.",bootbox.alert(a))}),$(".twitter-channel-container").on("click","button",function(){var e,t,a,n;"delete-twitter-channel-new"===$(this).attr("data-option")&&(e=$(this).text().split("("),t=e[0].substring(0,e[0].length-1),a=e[1].substring(0,e[1].length-2),console.log(t+" | "+a),n=$("#twitter-channels").val(),$(this).remove(),$("#twitter-channels").val(n.replace("[-1]["+a+"]["+t+"]||","")))}),$(".instagram-channel-container").on("click","button",function(){var e,t,a,n;"delete-instagram-channel-new"===$(this).attr("data-option")&&(e=$(this).text().split("("),t=e[0].substring(0,e[0].length-1),a=e[1].substring(0,e[1].length-2),console.log(t+" | "+a),n=$("#instagram-channels").val(),$(this).remove(),$("#instagram-channels").val(n.replace("[-1]["+a+"]["+t+"]||","")))}),$("#dynAddYoutubeButton").click(function(e){var t,a,n;e.preventDefault(),t={},a="",t.yt_type=$("#youtube-relation-type").val(),t.yt_id=$("#youtube-relation-id").val(),t.yt_title=$("#youtube-relation-title").val(),t.yt_team=$("#youtube-relation-reluid").val(),$("#youtube-relation-type").val(""),$("#youtube-relation-id").val(""),$("#youtube-relation-title").val(""),""!==t.yt_type&&""!==t.yt_id&&""!==t.yt_title?(n=$("#youtube-relations").val(),$("#youtube-relations").val(n+"[-1]["+t.yt_type+"]["+t.yt_id+"]["+t.yt_title+"]||"),$(".youtube-video-container").append('<button class="btn red" type="button" data-option="delete-youtube-new">'+t.yt_title+" ("+t.yt_type.substring(0,1).toUpperCase()+t.yt_type.substring(1)+": "+t.yt_id+') <i class="fa-ban fa"></i></button>&nbsp;'),a="<h3>Erfolg</h3><br/>Video Relation wurde erfolgreich hinzugefügt.",bootbox.alert(a)):(a="<h3>Fehler</h3><br/>Sie müssen alle Felder ausfüllen.",bootbox.alert(a))}),$(".youtube-video-container").on("click","button",function(){var e,t,a,n,l;"delete-youtube-new"===$(this).attr("data-option")&&(e=$(this).text().split("("),t=e[0].substring(0,e[0].length-1),e=e[1].split(": "),a=e[0].toLowerCase(),n=e[1].substring(0,e[1].length-2),l=$("#youtube-relations").val(),$(this).remove(),$("#youtube-relations").val(l.replace("[-1]["+a+"]["+n+"]["+t+"]||","")))}),$("#dynAddKeywordButton").click(function(e){e.preventDefault();var t={};t.keyword=$("#s2id_keywordselect .select2-chosen").text().replace(" [neu]",""),t.keyword_uid=$("#keywordselect").val(),t.sport_uid=$("#keyword_sport_uid").val(),t.category_uid=$("#keyword_category_uid").val(),$("#keyword_tournament_uid").length>0&&(t.tournament_uid=$("#keyword_tournament_uid").val()),$("#keyword_unique_tournament_uid").length>0&&(t.unique_tournament_uid=$("#keyword_unique_tournament_uid").val()),t.team_uid=$("#keyword_team_uid").val(),t.ref_table=$("#keyword_ref_table").val(),t.ref_uid=$("#keyword_ref_uid").val(),$.ajaxSetup({data:{csrf_betitbest_securitytoken:csrf_value}}),$.post("/backend/keyword/add_new",{data:t,dataType:"json"},function(e){var t,a,n,l,r;t="","ERROR"===e.status?t="<h3>Fehler</h3><br/>"+e.message:(a=e.data.added,n=$('<button type="button" id="added-keyword-matching-'+a.uid+'" data-option="delete-keyword-matching-'+a.uid+'" />'),n.addClass("btn"),1===parseInt(e.dynamic,10)?n.addClass("yellow"):n.addClass("red"),l="",null!==a.sp_name&&(l+=a.sp_name.toString().length>0?"Sport: "+a.sp_name+" ":""),null!==a.cat_name&&(l+=a.cat_name.toString().length>0?"Kategorie: "+a.cat_name+" ":""),null!==a.tn_name&&(l+=a.tn_name.toString().length>0?"Turnier: "+a.tn_name+" ":""),null!==a.untn_name&&(l+=a.untn_name.toString().length>0?"Turnier: "+a.untn_name+" ":""),l.length>0&&(l=" ( "+l+")"),$("#keyword_ref_table").length>0?n.html(l.substring(3,l.length-2)+'&nbsp;<i class="fa fa-ban"></i>'):n.html("Team: "+$("input#name").val()+l+'&nbsp;<i class="fa fa-ban"></i>'),$("#keyword_uid_"+a.keyword_uid).length>0?$("#keyword_uid_"+a.keyword_uid+" .margin-bottom").append(n):(r=$('<div class="form-group" id="keyword_uid_'+a.keyword_uid+'"></div>'),$('<label class="col-md-3 control-label">'+a.keyword_value+"</label>").appendTo(r),$('<div class="col-md-9"><div class="margin-bottom"></div></div>').appendTo(r),$(".keyword-container").append(r),$("#keyword_uid_"+a.keyword_uid+" .margin-bottom").append(n)),t="<h3>Erfolg</h3><br/>"+e.message),bootbox.alert(t)},"json")}),$(".editablestring").length&&($.ajaxSetup({data:{csrf_betitbest_securitytoken:csrf_value}}),$(".editablestring").editable()),$("#saveNavSorting").length&&($.ajaxSetup({data:{csrf_betitbest_securitytoken:csrf_value}}),$("#saveNavSorting").click(function(){var e,t;e=1,t=[],$("#nestable_list_navigation .dd-item").each(function(){t.push([$(this).attr("data-nav-id"),e++])}),$.post("/backend/frontend/reorder_nav",{data:t},function(e){bootbox.alert(e)})})),$("#saveLanguageSorting").length&&($.ajaxSetup({data:{csrf_betitbest_securitytoken:csrf_value}}),$("#saveLanguageSorting").click(function(){var e,t;e=1,t=[],$("#nestable_list_langs .dd-item").each(function(){t.push([$(this).attr("data-id"),e++])}),$.post("/backend/language/reorder",{data:t},function(e){bootbox.alert(e)})}))},r=function(){if("undefined"!=typeof toasterMessage){var e=toasterMessage;bootbox.alert(e)}},o=function(){$.ajaxSetup({data:{csrf_betitbest_securitytoken:csrf_value}}),$(".select2").each(function(){var e=$("option",this).first().text();$("option",this).first().val("").text(""),$(this).select2({allowClear:!0,placeholder:e})}),$("#blacklistselect").select2({placeholder:"Keyword eingeben",minimumInputLength:2,allowClear:!0,multiple:!0,ajax:{url:"/backend/keyword/getBlacklistDropdown",dataType:"json",quietMillis:250,data:function(e,t){return{q:e,page:t,team:$("input#uid").val()}},results:function(e,t){var a,n;return a=30*t<e.count,-1===e.result[0].uid&&(e.result[0].uid-=$("#s2id_blacklistselect li").length-1),n=$.map(e.result,function(e){return{id:e.uid,text:e.value}}),{results:n,more:a}}},initSelection:function(e,t){var a,n,l,r;for(a=[],n=$(e).data("option").split("||"),l=e.val().split(","),r=0;r<l.length;++r)a.push({id:l[r],text:n[r]});t(a)},dropdownCssClass:"bigdrop",escapeMarkup:function(e){return e}}),$("#keywordselect").select2({placeholder:"Keyword eingeben",minimumInputLength:2,allowClear:!0,ajax:{url:"/backend/keyword/getKeywordDropdown",dataType:"json",quietMillis:250,data:function(e,t){return{q:e,page:t,team:$("input#uid").val()}},results:function(e,t){var a,n;return a=30*t<e.count,n=$.map(e.result,function(e){return{id:e.uid,text:e.value}}),{results:n,more:a}}},initSelection:function(e,t){var a,n,l;a=e.val(),n=e.data("option"),l={id:a,text:n},t(l)},dropdownCssClass:"bigdrop",escapeMarkup:function(e){return e}}),$("#teamSelect, #teamSelect2").select2({placeholder:"Mannschaft w&auml;hlen",minimumInputLength:2,allowClear:!0,ajax:{url:"/backend/team/getTeamDropdown",dataType:"json",quietMillis:250,data:function(e,t){return{q:e,page:t}},results:function(e,t){var a=30*t<e.count;return{results:$.map(e.result,function(e){return{id:e.uid,text:e.name+" ["+e.gender+'] <i class="grey">('+e.sportname+" -> "+e.categoryname+" -> "+e.tournamentname+")</i>"}}),more:a}}},initSelection:function(e,t){var a,n,l;a=e.val(),n=e.data("option"),l={id:a,text:n},t(l)},dropdownCssClass:"bigdrop",escapeMarkup:function(e){return e}})},i=function(){$("body").on("click","a.must-confirm",function(e){var t,a,n;e.preventDefault(),t=$(e.currentTarget).attr("data-message"),a=$(e.currentTarget).attr("href"),n=void 0!==t?t:"Sind Sie sicher?",bootbox.confirm(n,function(e){e&&(window.location.href=a)})})},s=function(){$("#edit_sport_form, #edit_category_form, #edit_tournament_form, #edit_team_form").submit(function(){var e,t,a,n;for(e=$("#blacklistselect").val().split(","),t="",a=$(".select2-choices li div",$("#blacklistselect").parent()),n=0;n<e.length;++n)t+=parseInt(e[n],10)<0?$(a[n]).text().replace(" [neu]","")+"||":e[n]+"||";t.length>0&&(t=t.substring(0,t.length-2)),$("#blacklistselect").val(t)})},u=function(){if($(".dashboard-container").length){var e=function(){$.ajax({dataType:"json",type:"POST",url:"/backend/home/getAsync",data:{csrf_betitbest_securitytoken:csrf_value},success:function(e){}})};e(),setInterval(e,2e3)}},{init:function(){e(),r(),l(),n(),i(),o(),s(),u()}}}(),a.init(),$(document).ready(function(){$("#logo").fileinput({showUpload:!1,previewFileType:"any"}),e.init()})}();