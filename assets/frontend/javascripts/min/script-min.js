function handle_bet(e){var a=e;if(!a.hasClass("disabled")){var t=$("#match-"+a.attr("data-matchid")),o=$("#ticket_container");if(a.hasClass("active"))$('.ticket[data-matchid="'+a.attr("data-matchid")+'"][data-bet-team="'+a.attr("data-bet-team")+'"]').remove(),a.removeClass("active");else{var n=$("#ticketskel").clone();n.removeAttr("id").addClass("ticket open").removeClass("hidden disabled"),n.attr("data-matchid",a.attr("data-matchid")).attr("data-bet-team",a.attr("data-bet-team"));var d=[];d[1]=$(".team1 .name",t).clone(),$("i",d[1]).remove(),d[2]=$(".team2 .name",t).clone(),$("i",d[2]).remove(),$("#no_tickets_message").hide(),$(".ticket",o).removeClass("open"),$(".team1",n).html(d[1].html()),$(".team2",n).html(d[2].html()),$(".bet_on_team",n).html(d[parseInt(a.attr("data-bet-team"))]),a.addClass("active"),o.append(n)}}console.log(a)}function updateOdds(){var e=location.hash.substring(1).split("/"),a="";a=3===e.length?"/"+language+"/home/get_matches/"+e[0]+"/"+e[1]:5===e.length?"/"+language+"/home/get_matches/category/"+e[3]:7===e.length?"/"+language+"/home/get_matches/tournament/"+e[5]:"/"+language+"/home/get_matches",$.ajax({url:a}).done(function(e){var a=$.parseJSON(e);$(".gametable .row").addClass("outdated");for(var t=0;t<a.matches.length;++t){var o=a.matches[t],n=t,d=parseFloat(o.odd1),r=parseFloat(o.oddx),l=parseFloat(o.odd2);if(t<a.matches.length-1){for(var i=1;t+i<a.matches.length&&a.matches[t+i].uid===o.uid;++i)parseFloat(a.matches[t+i].odd1)>d&&(d=parseFloat(a.matches[t+i].odd1)),parseFloat(a.matches[t+i].oddx)>r&&(r=parseFloat(a.matches[t+i].oddx)),parseFloat(a.matches[t+i].odd2)>l&&(l=parseFloat(a.matches[t+i].odd2)),++n;t=n}if(0===$(".gametable .row#match-"+o.uid).length){if(t>0)var s=$(".row#match-"+a.matches[t-1].uid);var m;m=r>0?$(".maincontent .row.w3").first().clone():$(".maincontent .row.w2").first().clone(),$(m).attr("id","match-"+o.uid).addClass("added").removeClass("outdated"),$(".betHandle",m).attr("data-matchid",o.uid);var h=new Date(1e3*o.date),c=h.getDate();c=c>9?c:"0"+c;var g=h.getMonth()+1;g=g>9?g:"0"+g;var u=h.getHours();u=u>9?u:"0"+u;var v=h.getMinutes();v=v>9?v:"0"+v,$(".date",m).html(c+"."+g+"."),$(".time",m).html(u+":"+v);var p=o.team1name,f=o.team2name;p.length>25&&(p=p.substring(0,22)+"..."),f.length>25&&(f=f.substring(0,22)+"..."),$(".team1",m).attr("data-bet-odd",parseFloat(o.odd1).toFixed(2)),$(".team1 .name",m).html(p+"<i>"+parseFloat(o.odd1).toFixed(2)+"</i>"),$(".teamx",m).attr("data-bet-odd",parseFloat(o.oddx).toFixed(2)),$(".teamx i",m).html(parseFloat(o.oddx).toFixed(2)),$(".team2",m).attr("data-bet-odd",parseFloat(o.odd2).toFixed(2)),$(".team2 .name",m).html(f+"<i>"+parseFloat(o.odd2).toFixed(2)+"</i>"),t>0?(console.log("ADDED MATCH "+m.attr("id").replace("match-","")+" AFTER LAST MATCH WITH UID: "+s.attr("id").replace("match-","")),console.log(s),console.log(m),$(s).after(m.prop("outerHTML"))):(console.log("ADDED MATCH "+m.attr("id").replace("match-","")+" TO FIRST ROW"),$(".gametable .row").eq(0).before(m.prop("outerHTML")))}else{var C=$('.betHandle.team1[data-matchid="'+o.uid+'"]');parseFloat($("i",C).html())!=d&&(parseFloat($("i",C).html())>d?($(C).addClass("changed lower"),console.log("ODD 1 FOR MATCH "+o.uid+" DROPPED")):($(C).addClass("changed higher"),console.log("ODD 1 FOR MATCH "+o.uid+" RAISED")),$("i",C).html(d.toFixed(2)));var b=$('.betHandle.teamx[data-matchid="'+o.uid+'"]');parseFloat($("i",b).html())!=r&&(parseFloat($("i",b).html())>r?($(b).addClass("changed lower"),console.log("ODD X FOR MATCH "+o.uid+" DROPPED")):($(b).addClass("changed higher"),console.log("ODD X FOR MATCH "+o.uid+" RAISED")),$("i",b).html(r.toFixed(2)),parseFloat(r)>0?($(b).removeClass("hidden"),$(b).parent(".row").addClass("w3").removeClass("w2")):$(b).addClass("hidden").addClass("w2").removeClass("w3"));var F=$('.betHandle.team2[data-matchid="'+o.uid+'"]');parseFloat($("i",F).html())!=l&&(parseFloat($("i",F).html())>l?($(F).addClass("changed lower"),console.log("ODD 2 FOR MATCH "+o.uid+" DROPPED")):($(F).addClass("changed higher"),console.log("ODD 2 FOR MATCH "+o.uid+" RAISED")),$("i",F).html(l.toFixed(2)))}$(C).parent(".row").removeClass("outdated")}$(".gametable .row.outdated").each(function(){console.log("DELETED "+$(".gametable .row.outdated").length+" OUTDATED MATCHES");var e=$(this);console.log("DELETED OUTDATED MATCH"+e.attr("id").replace("match-","")),$('#ticket_container .ticket[data-matchid="'+e.attr("id").replace("match-","")+'"]').length>0&&$('#ticket_container .ticket[data-matchid="'+e.attr("id").replace("match-","")+'"]').remove(),0===e.siblings().length?(e.parent().prev().prev().is("h3")&&e.parent().next().is("h3")&&e.parent().prev().prev().remove(),e.parent().prev().is("h4")&&e.parent().prev().remove(),e.parent(".gametable").remove()):e.remove()}),setTimeout(function(){$(".betHandle.changed").removeClass("higher").removeClass("lower").removeClass("changed"),$(".row.added").removeClass("added")},2500)})}function checkModal(){$(".modal-close").click(function(){var e=$(this).parents(".modal");e.fadeOut(500,function(){$(this).next(".modal-overlay").fadeOut(100,function(){$(this).remove()}),$(this).remove()})}),$("#login_form").length&&$("#login_form").submit(function(e){e.preventDefault();var a=$(this).serializeArray(),t=$(this).attr("action");$.ajax({url:t,type:"POST",data:a,success:function(e,a,t){e=$.parseJSON(e),"success"==e.status?document.location.href=document.location.href:"error"==e.status},error:function(e,a,t){}})})}function navigate(){var e=location.hash.substring(1).split("/"),a="";3===e.length?a="/"+language+"/home/get_matches/"+e[0]+"/"+e[1]:5===e.length?a="/"+language+"/home/get_matches/category/"+e[3]:7===e.length&&(a="/"+language+"/home/get_matches/tournament/"+e[5]),$.ajax({url:a}).done(function(a){$("#sidebar-navigation li").removeClass("active"),$('#sidebar-navigation a[href="'+location.hash+'"]').parent().addClass("active"),$(".dropdown_menu",$("#filter")).removeClass("active"),$("#subcategory_menu").html("");var t=$.parseJSON(a),o="Highlights "+t.category.name,n="",d=$(".gametable .row").first().clone();$(".name, .date, .time",d).html(""),$(d).removeAttr("id"),$(".hover",d).removeClass("hover");var r=t.categories;if(t=t.matches,3===e.length&&($("#category_menu").html(""),r.length>0)){for(var l="",i=0;i<r.length;++i)l+='<li><a href="'+location.hash+"/"+r[i].uid+"/"+r[i].urlname+'">'+r[i].name+" <small>"+r[i].oddcount+"</small></a></li>";$("#category_menu").html(l)}if(5===e.length&&($("#subcategory_menu").html(""),r.length>0)){for(var l="",i=0;i<r.length;++i)l+='<li><a href="'+location.hash+"/"+r[i].uid+"/"+r[i].urlname+'">'+r[i].name+" <small>"+r[i].oddcount+"</small></a></li>";$("#subcategory_menu").html(l).parent("li").removeClass("hidden")}if(t.length>0){var s=t[0].categoryname,m=t[0].tournamentname;n+="<h3>"+s+"</h3>",n+="<h4>"+m+"</h4>";for(var i=0;i<t.length;++i){$(d).removeClass("w2").removeClass("w3"),$(d).attr("id","match-"+t[i].uid),$(".teamx",d).removeClass("hidden"),s!==t[i].categoryname?(s=t[i].categoryname,n+="</div>",n+="<h3>"+s+"</h3>",m=t[i].tournamentname,n+="<h4>"+m+"</h4>",n+='<div class="gametable">'):m!=t[i].tournamentname&&(m=t[i].tournamentname,n+="</div>",n+="<h4>"+m+"</h4>",n+='<div class="gametable">'),0===i&&(n+='<div class="gametable">');var h=new Date(1e3*t[i].date),c=h.getDate();c=c>9?c:"0"+c;var g=h.getMonth()+1;g=g>9?g:"0"+g;var u=h.getHours();u=u>9?u:"0"+u;var v=h.getMinutes();v=v>9?v:"0"+v,$(".date",d).html(c+"."+g+"."),$(".time",d).html(u+":"+v);var p=parseFloat(t[i].odd1),f=parseFloat(t[i].oddx),C=parseFloat(t[i].odd2),b=i;if(i<t.length-1){for(var F=1;i+F<t.length&&t[i+F].uid==t[i].uid;++F)parseFloat(t[i+F].odd1)>p&&(p=parseFloat(t[i+F].odd1)),parseFloat(t[i+F].odd2)>C&&(C=parseFloat(t[i+F].odd2)),parseFloat(t[i+F].oddx)>f&&(f=parseFloat(t[i+F].oddx)),++b;i=b}0===f?($(".teamx",d).addClass("hidden"),$(d).addClass("w2")):$(d).addClass("w3");var _=t[i].team1name,D=t[i].team2name;_.length>25&&(_=_.substring(0,22)+"..."),D.length>25&&(D=D.substring(0,22)+"..."),$(".betHandle",d).attr("data-matchid",t[i].uid),$(".team1",d).attr("data-bet-odd",p.toFixed(2)),$(".team1 .name",d).html(_+"<i>"+p.toFixed(2)+"</i>"),$(".teamx",d).attr("data-bet-odd",f.toFixed(2)),$(".teamx i",d).html(f.toFixed(2)),$(".team2",d).attr("data-bet-odd",C.toFixed(2)),$(".team2 .name",d).html(D+"<i>"+C.toFixed(2)+"</i>"),n+=d.prop("outerHTML")}n+="</div>",$(".maincontent").html("").append("<h2>"+o+"</h2>"+n),$("#main").scrollTop(0).perfectScrollbar("update")}})}$("#sidebar-navigation li").first().click(function(){$("#codeigniter_profiler").show()}),$(document).on("click","#ci_profiler_benchmarks",function(){$("#codeigniter_profiler").hide()}),$(document).ready(function(){$("#ticket_container").on("click",".ticket .head",function(){$(this).parent(".ticket").hasClass("open")||($("#ticket_container .ticket").removeClass("open"),$(this).parent(".ticket").addClass("open"))}),$("#ticket_container").on("click",".ticket .delete",function(){var e=$(this).parents(".ticket");$('.gametable .betHandle[data-matchid="'+e.attr("data-matchid")+'"][data-bet-team="'+e.attr("data-bet-team")+'"]').trigger("click")}),setInterval(function(){updateOdds()},1e4),location.hash.length>0&&navigate(),$("#main").removeClass("hidden"),$(".maincontent").on("click",".betHandle",function(){handle_bet($(this))}),$(".toggle_user_menu").click(function(){$(".toggle_user_menu.handle").toggleClass("open"),$(".user_menu_body").toggleClass("open")}),$("#filter").on("click",".dropdown_handle",function(e){e.preventDefault();var a=$(".dropdown_menu."+$(this).data("target"),$("#filter"));$("li",a).length>0&&a.toggleClass("active")}),$("#user_nav .withSub").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),$("#sidebar").hover(function(){$(this).addClass("hover"),$("#main, #ticket, header, #user_main").addClass("offCanvas")},function(){$(this).removeClass("hover"),$("#main, #ticket, header, #user_main").removeClass("offCanvas")}),$(".maincontent").on("mouseover",".betHandle",function(){$(this).addClass("hover")}),$(".maincontent").on("mouseout",".betHandle",function(){$(this).removeClass("hover")}),$("#main, #ticket").perfectScrollbar(),$("#login_button").click(function(){$(".modal").length&&$(".modal").remove(),$.ajax({url:"/"+language+"/user/form_login"}).done(function(e){var a=$(e).first(),t=$(e).last();a.css({width:a.data("width")+"px",height:a.data("height")+"px"}),$("body").append(a),$("body").append(t),$(".modal, .modal-overlay").animate({opacity:1},500),checkModal()})})}),$(window).bind("hashchange",function(){navigate()});